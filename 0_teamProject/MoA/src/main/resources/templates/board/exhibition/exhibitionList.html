<!DOCTYPE html>
<html lang="en"  xmlns="http://www.thymeleaf.org"> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${exhibitionName}">전시 게시판: 전체 목록</title>    

    <link rel="stylesheet" th:href="@{/css/board/exhibition/exhibitionList-style.css}">
    <link rel="stylesheet" th:href="@{/css/main-style.css}">

    <!-- 좋아요 heart? -->
    <!-- <script src="https://kit.fontawesome.com/f7459b8054.js" crossorigin="anonymous"></script> -->
    <!-- notification -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />

</head>
<body>


    <!-- <div th:replace="common/header :: header"></div> -->
    <!-- 템플릿 common/header 안의 header 라는 fragment(프래그먼트) 만 골라서 현재 태그(여기서는 <div>)를 그 프래그먼트의 내용으로 완전히 대체(replace) 합니다. -->
    <th:block th:replace="~{/common/header}">header.html</th:block>
    <!-- ~{...}(타임리프의 link/url expression)으로 템플릿 경로 /common/header 를 해석하여 전체 템플릿(혹은 기본 루트 프래그먼트)을 가져와 현재 자리를 대체합니다. (즉, 명시적 프래그먼트 이름을 안 쓴 경우 템플릿 전체 또는 템플릿의 기본 출력이 삽입됨.) -->
    <!-- 전체를 감싸는 태그 -->
    <div id="page-wrapper">
      
        <!-- [ [${map.exhibitionList}] ] ok -->

      <!-- main-태그 내부에서만 사용하는 변수 (전역변수 선언은 body태그 안에 선언) -->
      <main th:with="pagination=${map.pagination}, exhibitionList=${map.exhibitionList}, totalListCount = ${map.totalListCount}, exhibitionListCurrent=${map.exhibitionListCurrent},  exhibitionListFuture=${map.exhibitionListFuture}, exhibitionListPast=${map.exhibitionListPast}" >

        <th:block th:with="communityName='전시게시판', cntCurr=${map.eventPeriodCount.cntCurrent}, cntFut=${map.eventPeriodCount.cntFuture},cntPast=${map.eventPeriodCount.cntPast},cntNull=${map.eventPeriodCount.cntNull} " >
            <span class="board-title-event-period-counter">
                <h1 class="board-name" th:text="${communityName}">게시판 이름</h1> 
                <p th:text ="|현재 진행중인 전시 ${cntCurr}건,  예정전시 ${cntFut}건, 지난전시 ${cntPast}건, 전시기간 정보 미제공 ${cntNull}건|">현재, 미래, 지난전시 수 표시</p>
            </span> 
        </th:block>

        <!-- 본문:  -->
        <div id="content-wrapper">
            <!-- 본문 상단 영역 -->
            <div id="content-top">
                <div id="contop-sub1"></div>
            </div>

            <!-- 본문 중앙 영역 -->
            <div id="content-middle">
                <!-- 본문 중앙-Center: 실제 모든 내용 여기에 -->
                    <div id="section-container">
                        <!-- 카드목록 브라우징 영역 -->
                        <section id="section-card-list">
                            <div class="card-pyypresent"  id="card-present">
                                <div class="card-title present" id="card-title-present" >현재 진행중인 전시</div>
                                <div class="slider-container">
                                    <button class="slider-button left present" id="leftBtnPresent" onclick="slideLeftPresent()">&lt;</button>
                                    <div class="slider-wrapper present" id="sliderWrapperPresent">
                                        <div class="slide present" th:each="item : ${exhibitionListCurrent}">
                                            <div class="slide-item present">
                                                <a th:href="@{'/board/3/'+ ${item.exhibitNo}}">
                                                    <img  th:unless="${item.exhibitImgObject}" class="slider-thumbnail"  th:src="|${item.imageList[0].imgPath}${item.imageList[0].imgOrig}|" id="exhibitionPosterPast">
                                                    <img  th:if="${item.exhibitImgObject}" class="slider-thumbnail"  th:src="|${item.imageList[0].imgPath}${item.imageList[0].imgOrig}|" id="exhibitionPosterPast">
                                                    <h4 th:text="${item.exhibitTitle}">전시제목</h4>
                                                    <p th:unless="${item.exhibitDate}" th:text=" '전시기간: 전시기관에 문의해주세요' ">기간</p>
                                                    <p th:if="${item.exhibitDate}" th:text="'전시기간: ' + ${item.exhibitDate}">기간</p>
                                                    <p th:text="${item.exhibitInstitution}">전시기관</p>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="slider-button right present" id="rightBtnPresent" onclick="slideRightPresent()">&gt;</button>
                                </div>

                            </div>
                            <div class="card-pyyfuture" id="card-future">
                                <div class="card-title future" id="card-title-future">예정 전시</div>
                                <div class="slider-container">
                                    <button class="slider-button future left" id="leftBtnFuture" onclick="slideLeftFuture()">&lt;</button>
                                    <div class="slider-wrapper future" id="sliderWrapperFuture">
                                        <div class="slide future" th:each="item : ${exhibitionListFuture}">
                                            <div class="slide-item future">
                                                <a th:href="@{'/board/3/'+ ${item.exhibitNo}}">
                                                    <img  th:unless="${item.exhibitImgObject}" class="slider-thumbnail"  th:src="|${item.imageList[0].imgPath}${item.imageList[0].imgOrig}|" id="exhibitionPosterPast">
                                                    <img  th:if="${item.exhibitImgObject}" class="slider-thumbnail"  th:src="|${item.imageList[0].imgPath}${item.imageList[0].imgOrig}|" id="exhibitionPosterPast">
                                                   <h4 th:text="${item.exhibitTitle}">전시제목</h4>
                                                    <p th:text="${item.exhibitDate} + '동안'">기간</p>
                                                    <p th:text="${item.exhibitInstitution}">전시기관</p>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="slider-button future right" id="rightBtnFuture" onclick="slideRightFuture()">&gt;</button>
                                </div>

                            </div>
                            <div class="card-pyyprevious" id="card-previous">
                                <div class="card-title past" id="card-title-past" >지난 전시</div>
                                <div class="slider-container">
                                    <button class="slider-button past left" id="leftBtnPast" onclick="slideLeftPast()">&lt;</button>
                                    <div class="slider-wrapper past" id="sliderWrapperPast">
                                        
                                        <div class="slide past" th:each="item : ${exhibitionListPast}">
                                            <div class="slide-item past">
                                                    <a th:href="@{'/board/3/'+ ${item.exhibitNo}}">
                                                        <img  th:unless="${item.exhibitImgObject}" class="slider-thumbnail"  th:src="|${item.imageList[0].imgPath}${item.imageList[0].imgOrig}|" id="exhibitionPosterPast">
                                                        <img  th:if="${item.exhibitImgObject}" class="slider-thumbnail"  th:src="|${item.imageList[0].imgPath}${item.imageList[0].imgOrig}|" id="exhibitionPosterPast">
                                                        <h4 th:text="${item.exhibitTitle}">전시제목</h4>
                                                        <p th:text="${item.exhibitDate} + '동안'">기간</p>
                                                        <p th:text="${item.exhibitInstitution}">전시기관</p>
                                                    </a>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    <button class="slider-button past right" id="rightBtnPast" onclick="slideRightPast()">&gt;</button>
                                </div>
                            </div>
                        </section>
    
                        <!-- Exhibition Table 영역 -->
                        <section id="section-table">
                            <div id="table-top-area">
                                <!-- 로그인 멤버 전시글 작성 -->
                                <div class="btn-area">
                                    <button th:if="${session.loginMember}" id="insertBtn">새전시 등록</button>    
                                </div>
                            </div>
    
                            <div id="table-list-exhibition">
                                <!-- 검색한 안한 경우 -->
                                <h3 th:unless="${param.query}" th:text='|전시 게시판 : 전체 목록 (총 ${totalListCount} 건)|'></h3>                            
                                <!-- 검색한 경우 -->
                                <h3 th:if="${param.query}" th:text='|전시 게시판 : "${param.query}"  검색 결과 (총 ${totalListCount} 건)|'></h3>
    
                                <!-- Exhibition List -->
                                <div class="list-table-wrapper">
                                    <table class="list-table">
                                        
                                        <thead>
                                            <tr>
                                                <th>글번호</th>
                                                <th>제목</th>
                                                <th>작성자</th>
                                                <th>작성일</th>
                                                <th>조회수</th>
                                                <th>좋아요</th>
                                            </tr>
                                        </thead>
    
                                        <tbody>
                                            <!-- 게시글 목록 조회 결과가 비어있다면 (즉 반환받은 exhibitionList가 null)-->
                                            <th:block th:if="${#lists.size(exhibitionList) == 0}">
                                                <tr>
                                                    <th colspan="6">게시글이 존재하지 않습니다.</th>
                                                </tr>
                                            </th:block>
    
    
                                            <!-- 게시글 목록 조회 결과가 있는 경우 -->
                                            <th:block th:unless="${#lists.size(exhibitionList) == 0}">
                                                <tr th:each = "exhibition : ${exhibitionList}">
                                                    <td th:text="${exhibition.exhibitNo}">게시글 번호</td>
                                                    <td> 
                                                        <!-- 로그인한 회원의 경우 만 -->
                                                        <div th:if="${session.loginMember != null}">
                                                            <img th:unless="${session.loginMember.profileImg}" class="list-thumbnail"  th:src="@{/images/board/exhibition/member/user.png}" id="memberProfile">
                                                            <!-- 프로필 이미지가 있는 경우 -->                                                        
                                                            <img th:if="${session.loginMember.profileImg}" class="list-thumbnail" th:src="@{${session.loginMember.profileImg}}" id="memberProfile">
                                                        </div>
                                                        <!-- 검색 X -->
                                                        <a th:unless="${param.key}" th:href="@{/board/{communityCode}/{exhibitionNo}(communityCode=${communityCode}, exhibitionNo=${exhibition.exhibitNo}, cp=${pagination.currentPage} )}" th:utext="${exhibition.exhibitTitle}">게시글 제목</a>  <!-- exhibition는 th:each 문에 exhibition 로, 루프돌고 있다 -->
                                                        <!-- 검색 O -->
                                                        <a th:if="${param.key}" th:href="@{/board/{communityCode}/{exhibitionNo}(communityCode=${communityCode}, exhibitionNo=${exhibition.exhibitNo}, cp=${pagination.currentPage}) , key=${param.key}, query=${param.query} }"  th:text="${exhibition.exhibitTitle}">게시글 제목</a>  <!-- exhibition는 th:each 문에 exhibition 로, 루프돌고 있다 -->
                                                    </td>
                                                    <td>[[${exhibition.memberNickname}]]</td>
                                                    <td>
                                                        <p th:if="${exhibition.exhibitCreateDate}">[[${exhibition.exhibitCreateDate}]]</p>
                                                        <p th:unless="${exhibition.exhibitCreateDate}">[[${exhibition.exhibitUpdateDate}]]</p>
                                                    </td>
                                                    <td>[[${exhibition.readCount}]]</td>
                                                    <td>[[${exhibition.likeCount}]]</td>
                                                </tr>
                                            </th:block>
    
                                        </tbody>
                                    </table>
                                </div>
                                
                            </div>
    
                            <div id="table-bottom-area"></div>
                        </section>
    
                        <!-- 전시게시판 데이블 pagination -->
                        <section id="section-pagination">
                            <!-- 게시글이 있을 때만 페이지네이션 보이기 -->
                            <div th:if="${#lists.size(exhibitionList) > 0}" class="pagination-area">
    
                                <!-- 검색을 하지 않은 경우 -->
                                <ul th:unless ="${param.query}" class="pagination">
                                
                                    <!-- 첫 페이지(cp=1)로 이동 -->
                                    <!-- communityCode : @PathVariable로 request scope에 세팅된 값 -->
                                    <li><a th:href="@{/board/{code}(code=${communityCode}, cp=1) }">&lt;&lt;</a></li>
                                    <!-- 첫페이지는 항상 cp=1로 고정값 -->
                
                                    <!-- 이전 목록 마지막 번호로 이동 -->
                                    <li><a th:href="@{/board/{code}(code=${communityCode}, cp=${pagination.prevPage} ) }">&lt;</a></li>
                
                                    <!-- 특정 페이지로 이동 -->
                                    <!-- #numbers.sequence(시작, 끝, [, step]) : 타임리프 시퀀스(내장)객체  
                                            -> 시작 이상, 끝 이하 까지 step만큼 증가하는 숫자를 발생시켜 리스트로 반환 
                                    -->
                                    <th:block th:each="i : ${#numbers.sequence(pagination.startPage, pagination.endPage, 1)}">
    
                                        <!-- 현재 보고있는 페이지 -->
                                        <li th:if="${pagination.currentPage == i}">
                                            <a class="current" th:text="${i}">현재 페이지</a>
                                        </li>
                                        
                                        <!-- 현재 페이지를 제외한 나머지 -->
                                        <li th:unless="${pagination.currentPage == i}">
                                            <a th:href="@{/board/{code}(code=${communityCode}, cp=${i}) }" th:text="${i}"></a>
                                        </li>
    
                                    </th:block>
                                    
                                    <!-- 다음 목록 시작 번호로 이동 -->
                                    <li><a th:href="@{/board/{code}(code=${communityCode}, cp=${pagination.prevPage} ) }">&gt;</a></li>
                
                                    <!-- 끝 페이지로 이동 -->
                                    <li><a th:href="@{/board/{code}(code=${communityCode}, cp=${pagination.maxPage} ) }">&gt;&gt;</a></li>            
                                </ul>
    
    
                                <!-- 검색을 한 경우 -->
                                <ul th:if ="${param.query}" class="pagination">
                                
                                    <!-- 첫 페이지(cp=1)로 이동 -->
                                    <!-- communityCode : @PathVariable로 request scope에 세팅된 값 -->
                                    <li><a th:href="@{/board/{code}(code=${communityCode}, cp=1) }">&lt;&lt;</a></li>
                                    <!-- 첫페이지는 항상 cp=1로 고정값 -->
                
                                    <!-- 이전 목록 마지막 번호로 이동 -->
                                    <li><a th:href="@{/board/{code}(code=${communityCode}, cp=${pagination.prevPage} ) }">&lt;</a></li>
                
                                    <!-- 특정 페이지로 이동 -->
                                    <!-- #numbers.sequence(시작, 끝, [, step]) : 타임리프 시퀀스(내장)객체  
                                            -> 시작 이상, 끝 이하 까지 step만큼 증가하는 숫자를 발생시켜 리스트로 반환 
                                    -->
                                    <th:block th:each="i : ${#numbers.sequence(pagination.startPage, pagination.endPage, 1)}">
    
                                        <!-- 현재 보고있는 페이지 -->
                                        <li th:if="${pagination.currentPage == i}">
                                            <a class="present" th:text="${i}">현재 페이지</a>
                                        </li>
                                        
                                        <!-- 현재 페이지를 제외한 나머지 -->
                                        <li th:unless="${pagination.currentPage == i}">
                                            <a th:href="@{/board/{code}(code=${communityCode}, cp=${i}, key=${param.key}, query=${param.query}) }" th:text="${i}"></a>
                                        </li>
    
                                    </th:block>
                
                                    
                                    <!-- 다음 목록 시작 번호로 이동 -->
                                    <li><a th:href="@{/board/{code}(code=${communityCode}, cp=${pagination.prevPage}, key=${param.key}, query=${param.query} ) }">&gt;</a></li>
                
                                    <!-- 끝 페이지로 이동 -->
                                    <li><a th:href="@{/board/{code}(code=${communityCode}, cp=${pagination.maxPage}, key=${param.key}, query=${param.query} ) }">&gt;&gt;</a></li>
                                </ul>
    
                            </div>
    
                        </section>

                    </div>
                    


            </div>

            <!-- 본문 하단 영역 -->
            <div id="content-bottom">
                <div id="conbot-sub1">

                    <!-- 전시 게시판 검색창 -->
                    <section id="section-search">
                        <!-- 검색창 -->
                        <form th:action="${communityCode}" method="get" id="exhibitionSearch">

                            <select name="key" id="searchKey">
                                <option value="c" >주제</option>
                                <option value="t">제목</option>
                                <option value="auth" >작가</option> 
                                <option value="i">전시기관</option>
                                <option value="p">전시일정:년도</option>
                                <option value="e">기타</option>
                            </select>

                            <input type="text" name="query"  id="searchQuery" placeholder="검색어를 입력해주세요.">
                            
                            <button>검색</button>
                        </form>

                    </section>

                </div>
            </div>

        </div>
        
        <!-- ######################################################## -->
        <!-- 푸터 : footer.html -->
        <!-- <div th:replace="common/footer :: footer"></div> -->
        <th:block th:replace="~{common/footer}">footer.html</th:block>

        <!-- confirm-alert-message window 창: footer.html에서 이미 declared 됐음 -->
        <!-- <script th:inline="javascript">
            const message = /*[[${message}]]*/ "전달 받은 message";

            console.log(message)

            if (message != null) alert(message);

        </script> -->

        <!-- 우측 상단 로그인 멤버 정보/ Notification 표시 -->
        <script th:src="@{/js/main.js}"></script>
        <!-- 로그인 정보 JS 변수 (모든 페이지에서 공통으로 렌더링됨): header.html에서 이미 declared 됐음 -->
        <!-- <script th:inline="javascript">
            const notificationLoginCheck = /*[[${session.loginMember} ? true : false]]*/ false;
            const notificationDefaultImage = /*[[@{/images/common/user.svg}]]*/ "/images/common/user.svg";
        </script> -->


        <script th:src="@{/js/board/exhibition/exhibitionList.js}"></script>


      </main>
    </div>
    
</body>
</html>